<!DOCTYPE html>
<html lang="en"><!-- use theme color or fallback -->
<!--use textcolor from settings, otherwise create a contrasting color to theme color-->
<head><meta charset="utf-8"/><link href="../../bootstrap/css/bootstrap.min.css" rel="stylesheet"/><link href="../../bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet"/><link href="../../bootstrap/css/bootstrap-select.min.css" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,700italic,400italic" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600,600italic,400" rel="stylesheet" type="text/css"/><link href="https://netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.css" rel="stylesheet" type="text/css"/><script src="../../jquery-1.9.1.min.js"></script><script src="../../bootstrap/js/bootstrap.min.js"></script><script src="../../bootstrap/js/bootstrap-select.min.js"></script><link href="../../styles.css" rel="stylesheet"/><link href="../../extra-styles.css" rel="stylesheet"/><link href="../../haxe-nav.css" rel="stylesheet"/><script type="text/javascript">var dox = {rootPath: "../../",platforms: ["cpp","cs","flash","hl","java","js","lua","macro","neko","php","python"]};</script><script type="text/javascript" src="../../nav.js"></script><script type="text/javascript" src="../../index.js"></script><link rel="icon" href="../../favicon.ico" type="image/x-icon"></link><title>neko.net.ServerLoop - Haxe development API</title><meta name="description" content="This class enables you to quickly create a custom server that can
serve several clients in parallel. This server is using a single
thread and process so the server itself processing is not parallel.
Non-blocking sockets are used to ensure that a slow client does not
block the others."/><link rel="canonical" href="https://api.haxe.org/v/development/neko/net/ServerLoop.html"/><script type="text/javascript">function startsWith(str, searchString){    return str.substr(0, searchString.length) === searchString;}if (!startsWith(location.href, "https://api.haxe.org/v/development")) {window.location.replace("https://api.haxe.org/v/development/neko/net/ServerLoop.html");}</script></head><body><style>
.main-content { margin-top:65px; }
.nav-list>.active>a.treeLink, .nav-list>.active>a.treeLink:hover, .nav-list>.active>a.treeLink:focus { background:#F48821; color:#fff; text-shadow:0 0 0 transparent; }
</style><nav class="section nav dark"><div class="navbar navbar-fixed-top navbar-inverse"><div class="navbar-inner"><button class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse" type="button"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button><a class="brand haxe-logo" href="https://haxe.org/"><img alt="Haxe" height="21" onerror="this.src='https://haxe.org/img/haxe-logo-horizontal-on-dark.png'" src="https://haxe.org/img/haxe-logo-horizontal-on-dark.svg" width="107"/></a><a class="brand sub lib" href="../../">API</a><div class="nav-collapse collapse"><ul class="nav"><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="/">Version development @ 037877b <b class="caret"></b></a><ul class="dropdown-menu"><li class=""><a href="/v/3.2.1">3.2.1</a></li><li class=""><a href="/v/3.3">3.3</a></li><li class=""><a href="/v/3.4.2">3.4.2</a></li><li class=""><a href="/v/3.4.4">3.4.4</a></li><li class=""><a href="/v/3.4.5">3.4.5</a></li><li class=""><a href="/">3.4.6</a></li><li><a href="/v/development" class="active">Development</a></li></ul></li><li class="divider"></li><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="https://haxe.org/documentation/">Learn Haxe <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://haxe.org/documentation/">Introduction</a></li><li class="divider"></li><li><a href="https://haxe.org/manual/">Manual</a></li><li class="active"><a href="http://api.haxe.org">API Documentation</a></li><li class="divider"></li><li><a href="http://try.haxe.org">Try Haxe</a></li><li><a href="https://lib.haxe.org">Haxelib</a></li><li><a href="http://code.haxe.org">Code Cookbook</a></li></ul></li><li class=" dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">Connect <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="https://github.com/HaxeFoundation" rel="external"><i class="fa fa-github"></i> Github</a></li><li><a href="https://github.com/HaxeFoundation/haxe/issues" rel="external"><i class="fa fa-github"></i> Bug reports</a></li><li><a href="https://stackoverflow.com/questions/tagged/haxe" rel="external"><i class="fa fa-stack-exchange"></i> Stack Overflow</a></li><li><a href="http://community.haxe.org/" rel="external"><i class="fa fa-envelope-o"></i> Forums</a></li><li><a href="https://gitter.im/HaxeFoundation/haxe" rel="external nofollow"><i class="fa fa-comments-o"></i> Chat</a></li><li><a href="https://haxe.org/blog"><i class="fa fa-rss"></i> Blog</a></li><li class="divider"></li><li><a href="https://www.facebook.com/haxe.org/" rel="external"><i class="fa fa-facebook"></i> Facebook</a></li><li><a href="https://twitter.com/search?q=%23haxe" rel="external"><i class="fa fa-twitter"></i> #haxe</a></li><li><a href="https://twitter.com/haxelang" rel="external"><i class="fa fa-twitter"></i> @haxelang</a></li><li><a href="https://twitter.com/haxe_org" rel="external"><i class="fa fa-twitter"></i> @haxe_org</a></li><li class="divider"></li><li><a href="https://haxe.org/foundation/contact.html">Contact</a></li></ul></li></ul></div></div></div></nav><div class="container main-content"><div class="row-fluid"><div class="span3"><div class="well sidebar-nav"><form class="form-search" id="searchForm"><div class="input-prepend input-block-level"><span class="add-on"><i class="icon-search"></i></span><input id="search" type="text" placeholder="Filter" autocomplete="off"/></div></form><div class="dropdown"><select id="select-platform" class="selectpicker" title="Filter by platform" data-width="100%"><option value="all" selected="true">All Platforms</option><option>cpp</option><option>cs</option><option>flash</option><option>hl</option><option>java</option><option>js</option><option>lua</option><option>macro</option><option>neko</option><option>php</option><option>python</option></select></div></div><div class="well sidebar-nav"><div id="nav"></div></div></div><div class="span9"><div class="page-header"><span class="viewsource"><a href="https://github.com/HaxeFoundation/haxe/blob/development/std/neko/net/ServerLoop.hx" class="btn btn-medium"><i class="fa fa-eye"></i> View source</a></span><h1><small>class</small> ServerLoop&lt;<span class="type">ClientData</span>&gt;</h1><h4><small>package <a href="../../neko/net/index.html">neko.net</a></small></h4>    <p class="availability"><hr/><em>Available on  neko</em></p></div><div class="body"><div class="doc doc-main"><div class="indent"><p>This class enables you to quickly create a custom server that can
serve several clients in parallel. This server is using a single
thread and process so the server itself processing is not parallel.
Non-blocking sockets are used to ensure that a slow client does not
block the others.</p></div></div><h3 class="section">Constructor</h3><div class="fields"><div class="field "><a name="new"></a><h3><p class="anchor"><code><a href="#new"><span class="identifier">new</span></a> (<span style="white-space:nowrap">?newData:<a class="type" title="A TCP socket class : allow you to both connect to a given server and exchange messages or start your own server and wait for connections." href="../../sys/net/Socket.html">Socket</a>&nbsp;&#8209;&gt;&nbsp;<span class="type">ClientData</span></span>)</code></p></h3><div class="doc"><p>Creates a server instance. The <code>newData</code> methods must return
the data associated with the Client.</p></div></div></div><h3 class="section">Variables</h3><div class="fields"><div class="field "><a name="clients"></a><h3><p class="anchor"><code><a href="../../neko/net/ServerLoop.html#clients"><span class="identifier">clients</span></a>:<a class="type" title="" href="../../List.html">List</a>&lt;<span class="type">ClientData</span>&gt;</code></p></h3><div class="doc"><p></p></div></div><div class="field "><a name="listenCount"></a><h3><p class="anchor"><code><a href="../../neko/net/ServerLoop.html#listenCount"><span class="identifier">listenCount</span></a>:<a class="type" title="The standard Int type." href="../../Int.html">Int</a></code></p></h3><div class="doc"><p>This is the value of number client requests that the server socket
listen for. By default this number is 10 but can be increased for
servers supporting a large number of simultaneous requests.</p></div></div><div class="field "><a name="updateTime"></a><h3><p class="anchor"><code><a href="../../neko/net/ServerLoop.html#updateTime"><span class="identifier">updateTime</span></a>:<a class="type" title="The standard Float type, this is a double-precision IEEE 64bit float." href="../../Float.html">Float</a></code></p></h3><div class="doc"><p>See <code>update</code>.</p></div></div></div><h3 class="section">Methods</h3><div class="fields"><div class="field "><a name="clientDisconnected"></a><h3><p class="anchor"><code><a href="#clientDisconnected"><span class="identifier">clientDisconnected</span></a> (<span style="white-space:nowrap">d:<span class="type">ClientData</span></span>):<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>This method is called after a client has been disconnected.</p></div></div><div class="field "><a name="clientWrite"></a><h3><p class="anchor"><code><a href="#clientWrite"><span class="identifier">clientWrite</span></a> (<span style="white-space:nowrap">s:<a class="type" title="A TCP socket class : allow you to both connect to a given server and exchange messages or start your own server and wait for connections." href="../../sys/net/Socket.html">Socket</a>,</span> <span style="white-space:nowrap">buf:<a class="type" title="" href="../../haxe/io/Bytes.html">Bytes</a>,</span> <span style="white-space:nowrap">pos:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>,</span> <span style="white-space:nowrap">len:<a class="type" title="The standard Int type." href="../../Int.html">Int</a></span>):<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>This method can be used instead of writing directly to the socket.
It ensures that all the data is correctly sent. If an error occurs
while sending the data, no exception will occur but the client will
be gracefully disconnected.</p></div></div><div class="field "><a name="closeConnection"></a><h3><p class="anchor"><code><a href="#closeConnection"><span class="identifier">closeConnection</span></a> (<span style="white-space:nowrap">s:<a class="type" title="A TCP socket class : allow you to both connect to a given server and exchange messages or start your own server and wait for connections." href="../../sys/net/Socket.html">Socket</a></span>):<a class="type" title="The standard Boolean type, which can either be true or false." href="../../Bool.html">Bool</a></code></p></h3><div class="doc"><p>Closes the client connection and removes it from the client List.</p></div></div><div class="field "><a name="onError"></a><h3><p class="anchor"><code><a href="#onError"><span class="identifier">onError</span></a> (<span style="white-space:nowrap">e:<a class="type" title="Dynamic is a special type which is compatible with all other types." href="../../Dynamic.html">Dynamic</a></span>):<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Called when an error occurred. This enable you to log the error somewhere.
By default the error is displayed using <code>trace</code>.</p></div></div><div class="field "><a name="processClientData"></a><h3><p class="anchor"><code><a href="#processClientData"><span class="identifier">processClientData</span></a> (<span style="white-space:nowrap">d:<span class="type">ClientData</span>,</span> <span style="white-space:nowrap">buf:<a class="type" title="" href="../../haxe/io/Bytes.html">Bytes</a>,</span> <span style="white-space:nowrap">bufpos:<a class="type" title="The standard Int type." href="../../Int.html">Int</a>,</span> <span style="white-space:nowrap">buflen:<a class="type" title="The standard Int type." href="../../Int.html">Int</a></span>):<a class="type" title="The standard Int type." href="../../Int.html">Int</a></code></p></h3><div class="doc"><p>This method is called when some data has been read into a Client buffer.
If the data can be handled, then you can return the number of bytes handled
that needs to be removed from the buffer. It the data can't be handled (some
part of the message is missing for example), returns 0.</p></div></div><div class="field "><a name="run"></a><h3><p class="anchor"><code><a href="#run"><span class="identifier">run</span></a> (<span style="white-space:nowrap">host:<a class="type" title="A given IP host name." href="../../sys/net/Host.html">Host</a>,</span> <span style="white-space:nowrap">port:<a class="type" title="The standard Int type." href="../../Int.html">Int</a></span>):<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>Run the server. This function should never return.</p></div></div><div class="field "><a name="update"></a><h3><p class="anchor"><code><a href="#update"><span class="identifier">update</span></a> ():<a class="type" title="The standard Void type." href="../../Void.html">Void</a></code></p></h3><div class="doc"><p>The <code>update</code> method is called after each socket event has been
processed or when <code>updateTime</code> has been reached. It can be used
to perform time-regular tasks such as pings. By default <code>updateTime</code>
is set to one second.</p></div></div></div><h3 class="section">Static variables</h3><div class="fields"><div class="field "><a name="DEFAULT_BUFSIZE"></a><h3><p class="anchor"><code><span class="label">static</span><a href="../../neko/net/ServerLoop.html#DEFAULT_BUFSIZE"><span class="identifier">DEFAULT_BUFSIZE</span></a>:<a class="type" title="The standard Int type." href="../../Int.html">Int</a><span> = 128</span></code></p></h3><div class="doc"><p>Each client has an associated buffer. This is the initial buffer size which
is set to 128 bytes by default.</p></div></div><div class="field "><a name="MAX_BUFSIZE"></a><h3><p class="anchor"><code><span class="label">static</span><a href="../../neko/net/ServerLoop.html#MAX_BUFSIZE"><span class="identifier">MAX_BUFSIZE</span></a>:<a class="type" title="The standard Int type." href="../../Int.html">Int</a><span> = (1 &lt;&lt; 16)</span></code></p></h3><div class="doc"><p>Each client has an associated buffer. This is the maximum buffer size which
is set to 64K by default. When that size is reached and some data can't be processed,
the client is disconnected.</p></div></div></div></div></div></div></div><footer class="section dark site-footer"><div class="container"><div class="copyright"><p>This documentation is generated for version development @ 037877b</p><p>&copy; 2018 &nbsp;<a href="https://haxe.org/foundation/" title="Haxe Foundation Website" rel="external" class="hf-link">Haxe Foundation</a> |&nbsp;<a href="https://github.com/HaxeFoundation/haxe" rel="external" title="Haxe on Github">Contribute to Haxe</a></p></div></div></footer><script src="../..//highlighter.js"></script><link href="../../highlighter.css" rel="stylesheet"/></body></html>